/*
 ============================================================================
 Name        : TP_1.c
 Author      : Lucia Lopez
 Version     :
 Copyright   : Your copyright notice
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>

int mostrarMenu(int retornoPrimerOperando, int retornoSegundoOperando, float primerOperando, float segundoOperando);
int obtenerNumeroFloat( float* pResultado, char* mensaje, char* mensajeError, int reintentos);
int sumarFloat(float* pResultado, float num1, float num2);
int restarFloat(float* pResultado, float num1, float num2);
int multiplicarFloat(float* pResultado, float num1, float num2);
int dividirFloat(float* pResultado, float num1, float num2);
int determinarEntero(int* pEntero, float numFloat);
int factorizar(int num);


int main(void) {

		setbuf(stdout,NULL);

		char seguir = 's';
	    int flag = 0;
	    float pPrimerOperando;
	    float pSegundoOperando;
	    int retornoPrimerOperando;
	    int retornoSegundoOperando;
	    float pSuma;
	    float pResta;
	    float pMulticacion;
	    float pDivision;
	    int retornoDivision;
	    int pFactorial1;
	    int pFactorial2;
	    int pEntero;


	    do{

	        switch(mostrarMenu(retornoPrimerOperando, retornoSegundoOperando,pPrimerOperando, pSegundoOperando)){

	            case 1:

	                retornoPrimerOperando = obtenerNumeroFloat(&pPrimerOperando, "Ingrese un numero: ", "Error.", 3);

	                break;

	            case 2:

	                retornoSegundoOperando = obtenerNumeroFloat(&pSegundoOperando, "Ingrese un numero: ", "Error.", 3);

	                break;

	            case 3:

	                if(retornoPrimerOperando == 1 && retornoSegundoOperando == 1){

	                    sumarFloat(&pSuma, pPrimerOperando,pSegundoOperando);

	                    restarFloat(&pResta, pPrimerOperando,pSegundoOperando);

	                    multiplicarFloat(&pMulticacion, pPrimerOperando,pSegundoOperando);

	                    retornoDivision = dividirFloat(&pDivision, pPrimerOperando,pSegundoOperando);

						if (determinarEntero(&pEntero, pPrimerOperando) ==0){

						pFactorial1 = factorizar(pEntero);

						} else {

							pFactorial1 = 0;}

						if (determinarEntero(&pEntero, pSegundoOperando) ==0){

						pFactorial2 = factorizar(pEntero);

						}
						else {
							pFactorial2 = 0;}

						flag = 1;

	                    }
	                else {

	                    printf("Para calcular las operaciones es necesario ingresar ambos operandos\n");

	                }

	                break;

	            case 4:

	                if(flag == 1){

	                    printf("a) El resultado de A = %.2f + B = %.2f es: %.2f\n", pPrimerOperando, pSegundoOperando, pSuma);

	                    printf("b) El resultado de A = %.2f - B = %.2f es: %.2f\n", pPrimerOperando, pSegundoOperando, pResta);

	                    if(retornoDivision == 0){

	                    printf("c) El resultado de A = %.2f / B = %.2f es: %.2f\n", pPrimerOperando, pSegundoOperando, pDivision);

	                    } else{

							printf("c) El resultado de A = %.2f / B = %.2f no se pudo calcular\n", pPrimerOperando, pSegundoOperando);

						}

	                    printf("d) El resultado de A = %.2f * B = %.2f es: %.2f\n", pPrimerOperando, pSegundoOperando, pMulticacion);

	                    if (pFactorial1 != 0 && pFactorial2 != 0){

	                    printf("e) El factorial de A = %.2f  es: %d y el factorial de B = %.2f  es: %d\n", pPrimerOperando, pFactorial1, pSegundoOperando, pFactorial2);

	                    } else if (pFactorial1 == 0 && pFactorial2 != 0){

	                    	printf("e) El factorial de A = %.2f no se pudo calcular y el factorial de B = %.2f  es: %d\n", pPrimerOperando, pSegundoOperando, pFactorial2);

	                    	} else {
	                                    if(pFactorial1 != 0 && pFactorial2 == 0){

	                                    	printf("e) El factorial de A = %.2f es: %d y el factorial de B = %.2f no se pudo calcular\n", pPrimerOperando, pFactorial1, pSegundoOperando);
	                                    }
	                                    else{

	                                        printf("e) El factorial de A = %.2f y de B = %.2f no se pudieron calcular\n", pPrimerOperando, pSegundoOperando);
	                                    }
	                            }

	                    flag = 0;}


	                else{

	                    printf("Para informar los resultados, se deben ingresar ambos operandos y calcular las operaciones\n");

	                	}
	                break;

	            case 5:

	                seguir = 'n';

	                printf("¿Quiere cancelar la salida?\n");

	                fflush(stdin);

	                scanf("%c", &seguir);

	                break;

	            default:

	                printf("Opcion invalida \n");

	        }

	        system("pause");

	    }while(seguir == 's');


	return EXIT_SUCCESS;
}




/// \fn int mostrarMenu(int, int, float, float)
/// \brief Permite mostrar el menu de opciones de una calculadora, retorna la opción seleccionada y muestra los operandos en caso de haber sido cargados.
/// \param retornoPrimerOperando : Indica si se ingreso el primer operando (valor = 1)
/// \param retornoSegundoOperando : Indica si se ingreso el primer operando (valor = 1)
/// \param primerOperando : Valor del primer operando
/// \param segundoOperando : Valor del primer operando
/// \return Retorna la opcion ingresada.

int mostrarMenu(int retornoPrimerOperando, int retornoSegundoOperando, float primerOperando, float segundoOperando) {

    int opcion;

    system("cls");
    printf("Menu de opciones\n\n");
    printf("1. Ingresar primer operando\n");
    printf("2. Ingresar segundo operando\n");
    printf("3. Calcular todas las operaciones\n");
    printf("4. Informar resultados\n");
    printf("5. Salir\n\n");

    if(retornoPrimerOperando == 1){

        printf("El primer operando ingresado (A) es %.2f\n", primerOperando);

    }

    if(retornoSegundoOperando == 1){

        printf("El segundo operando ingresado (B) es %.2f\n", segundoOperando);

    }

    printf("\nIndique opcion: ");
    fflush(stdin);
    scanf("%d", &opcion);

    return opcion;

}


/// \fn int obtenerNumeroFloat(float*, char*, char*, int)
/// \brief Permite ingresar un numero flotante y lo retorna
/// \param pResultado : Graba el resultado, es decir, el numero ingresado (tipo float)
/// \param mensaje : El mensaje a mostrar para solicitar el ingreso del numero
/// \param mensajeError : El mensaje de error a mostrar en caso de ingresar un valor no numerico
/// \param reintentos : La cantidad de veces que se permitirá reintentar ingresar el valor numerico
/// \return [1] Si pudo obtener el numero ingresado (float) - [-1] Sino pudo obtenerlo.

int obtenerNumeroFloat( float* pResultado, char* mensaje, char* mensajeError, int reintentos)
{
	int retorno = -1;
	float num;
	int resultadoScanf;


		do
		{
			printf("%s", mensaje);
			resultadoScanf = scanf( "%f" ,&num);
			fflush(stdin);

			if(pResultado != NULL && mensaje != NULL && mensajeError != NULL && resultadoScanf == 1)
			{
				* pResultado = num;
				retorno = 1;
				break;
			}
			else
			{
				printf("%s", mensajeError);
				fflush(stdin);
				reintentos--;
			}

		} while(reintentos>=1);

		return retorno;

}

/// \fn int sumarFloat(float*, float, float)
/// \brief Sumar dos numeros flotantes
/// \param pResultado : Graba el resultado de la suma de los dos numeros flotantes;
/// \param num1 : Primer numero a sumar;
/// \param num2 : Segundo numero a sumar;
/// \return : [1] error: la suma no se realizó - [0] éxito: la suma se realizó.

int sumarFloat(float* pResultado, float num1, float num2){

	int retorno = 1;

		if(pResultado != NULL){
			*pResultado = num1 + num2;
			retorno = 0;

		}

	return retorno;
}

/// \fn int restarFloat(float*, float, float)
/// \brief  Restar dos numeros flotantes
/// \param pResultado : Graba el resultado de la resta de los dos numeros flotantes;
/// \param num1 : Primer numero a restar;
/// \param num2 : Segundo numero a restar;
/// \return [1] error: la resta no se realizó - [0] éxito: la resta se realizó.

int restarFloat(float* pResultado, float num1, float num2){

	int retorno = 1;

		if(pResultado != NULL){
			*pResultado = num1 - num2;
			retorno = 0;

		}

	return retorno;
}

/// \fn int multiplicarFloat(float*, float, float)
/// \brief Multiplicar dos numeros flotantes
/// \param pResultado : Graba el resultado de la multiplicación de los dos numeros flotantes;
/// \param num1 : Primer numero a multiplicar;
/// \param num2 : Segundo numero a multiplicar;
/// \return [1] error: la multiplicación no se realizó - [0] éxito: la multiplicación se realizó.
///

int multiplicarFloat(float* pResultado, float num1, float num2){

	int retorno = 1;

		if(pResultado != NULL){
			 *pResultado = num1 * num2;
			retorno = 0;
			}

		if(*pResultado == -0){
			*pResultado = 0;
		}

	return retorno;
}


/// \fn int dividirFloat(float*, float, float)
/// \brief Dividir dos numeros flotantes
/// \param pResultado : Graba el resultado de la división de los dos numeros flotantes;
/// \param num1 : Primer numero a dividir;
/// \param num2 : Segundo numero a dividir;
/// \return [1] error: la división no se realizó - [0] éxito: la división se realizó.
///

int dividirFloat(float* pResultado, float num1, float num2){

	int retorno = 1;

		if(pResultado != NULL && num2 != 0){
			*pResultado = num1 / num2;
			retorno = 0;
			}

		if(*pResultado == -0){
			*pResultado = 0;
			}

	return retorno;
}

/// \fn int determinarEntero(int*, float)
/// \brief Determina si un numero flotante es entero (no tiene parte fraccionaria)
/// \param pEntero : Graba el entero
/// \param numFloat : Numero flotante a determinar si es entero o tiene parte fraccionaria.
/// \return [1] error: la determinacion no se realizó - [0] éxito: la determinacion se realizó.
///
int determinarEntero(int* pEntero, float numFloat){
    int retorno = 1;
    int numAEntero;

		numAEntero = numFloat;

		if (numFloat - numAEntero == 0){

			*pEntero = numAEntero;
			retorno = 0;

		}

    return retorno;
}

/// \fn int factorizar(int)
/// \brief Realizar la factorizacion de un numero entero positivo entre 0 y 12.
/// \param num : Numero entero a factoriza
/// \return [0] error: no se factorizo el numero - [distinto de cero] éxito: se factorizo el numero.
///
int factorizar(int num){

    int fact = 0;

		if (num >= 0 && num < 13) {
			fact = 1;
			for(int i = 2; i <= num; i++){
				fact = fact*i;
			}
		}

    return fact;
}

